🔔 Permission result: granted
chat-interface.tsx:324 ✅ Permission granted - will register when joining room
use-socket.ts:24 WebSocket connected
chat.tsx:22 Chat page loaded with roomId: vqfrj3
chat.tsx:125 showNicknameModal: false socket: true nickname: Obed2 isLoading: false
chat.tsx:66 Sending join-room message: {roomId: 'vqfrj3', nickname: 'Obed2', sessionId: 'session_1757368354772_0vv2j9r'}
chat.tsx:22 Chat page loaded with roomId: vqfrj3
chat.tsx:125 showNicknameModal: false socket: true nickname: Obed2 isLoading: false
chat.tsx:44 Found existing session for room: vqfrj3 nickname: Obed2
chat.tsx:22 Chat page loaded with roomId: vqfrj3
chat.tsx:125 showNicknameModal: false socket: true nickname: Obed2 isLoading: false
2chat-interface.tsx:446 📱 Sending visibility state: visible
use-socket.ts:24 WebSocket connected
chat.tsx:22 Chat page loaded with roomId: vqfrj3
chat.tsx:125 showNicknameModal: false socket: true nickname: Obed2 isLoading: false
chat.tsx:66 Sending join-room message: {roomId: 'vqfrj3', nickname: 'Obed2', sessionId: 'session_1757368354772_0vv2j9r'}
chat.tsx:22 Chat page loaded with roomId: vqfrj3
chat.tsx:125 showNicknameModal: false socket: true nickname: Obed2 isLoading: false
chat.tsx:44 Found existing session for room: vqfrj3 nickname: Obed2
chat.tsx:22 Chat page loaded with roomId: vqfrj3
chat.tsx:125 showNicknameModal: false socket: true nickname: Obed2 isLoading: false
2chat-interface.tsx:446 📱 Sending visibility state: visible
chat-interface.tsx:473 📱 MOBILE: Chat interface received message: welcome-message {type: 'welcome-message', message: 'Welcome back to Quick Chat Room, Obed2! 👋', roomId: 'vqfrj3', nickname: 'Obed2'}
chat-interface.tsx:474 📱 MOBILE: WebSocket readyState: 1
chat-interface.tsx:494 🎉 CLIENT: Received welcome message - triggering push registration
chat-interface.tsx:495 🔍 CLIENT: Welcome message data: {"type":"welcome-message","message":"Welcome back to Quick Chat Room, Obed2! 👋","roomId":"vqfrj3","nickname":"Obed2"}
chat-interface.tsx:508 📱 Welcome message: Triggering push registration for room: vqfrj3
chat-interface.tsx:509 🔍 CLIENT: About to call registerPushForRoom with: vqfrj3
chat-interface.tsx:510 🔍 CLIENT: Notification permission before call: granted
chat-interface.tsx:519 ⏳ DELAY: Waiting 1000ms for session to update before push registration
chat-interface.tsx:473 📱 MOBILE: Chat interface received message: session-restored {type: 'session-restored', room: {…}, messages: Array(5), participants: Array(3), nickname: 'Obed2'}
chat-interface.tsx:474 📱 MOBILE: WebSocket readyState: 1
chat-interface.tsx:487 🔥 CLIENT: Received room join/restore data: {type: 'session-restored', room: {…}, messages: Array(5), participants: Array(3), nickname: 'Obed2'}
chat-interface.tsx:473 📱 MOBILE: Chat interface received message: welcome-message {type: 'welcome-message', message: 'Welcome back to Quick Chat Room, Obed2! 👋', roomId: 'vqfrj3', nickname: 'Obed2'}
chat-interface.tsx:474 📱 MOBILE: WebSocket readyState: 1
chat-interface.tsx:494 🎉 CLIENT: Received welcome message - triggering push registration
chat-interface.tsx:495 🔍 CLIENT: Welcome message data: {"type":"welcome-message","message":"Welcome back to Quick Chat Room, Obed2! 👋","roomId":"vqfrj3","nickname":"Obed2"}
chat-interface.tsx:508 📱 Welcome message: Triggering push registration for room: vqfrj3
chat-interface.tsx:509 🔍 CLIENT: About to call registerPushForRoom with: vqfrj3
chat-interface.tsx:510 🔍 CLIENT: Notification permission before call: granted
chat-interface.tsx:519 ⏳ DELAY: Waiting 1000ms for session to update before push registration
chat-interface.tsx:446 📱 Sending visibility state: visible
chat-interface.tsx:521 🚀 DELAY COMPLETE: Now calling registerPushForRoom after session update
chat-interface.tsx:522 🔍 DELAY: About to call registerPushForRoom with roomId: vqfrj3
chat-interface.tsx:523 🔍 DELAY: Current Notification.permission: granted
chat-interface.tsx:338 🔍 REGISTER PUSH: Starting for room: vqfrj3 permission: granted
chat-interface.tsx:340 🏠 Registering push notifications for JOINED room: vqfrj3
chat-interface.tsx:351 🔄 Same room - skipping unsubscribe
chat-interface.tsx:113 🚀 Starting push notification setup...
chat-interface.tsx:120 ✅ Service worker supported
chat-interface.tsx:123 ⏳ Waiting for service worker ready...
install-prompt.tsx:85 === Chrome Install Check ===
install-prompt.tsx:87 Chrome detected - showing install instructions
chat-interface.tsx:521 🚀 DELAY COMPLETE: Now calling registerPushForRoom after session update
chat-interface.tsx:522 🔍 DELAY: About to call registerPushForRoom with roomId: vqfrj3
chat-interface.tsx:523 🔍 DELAY: Current Notification.permission: granted
chat-interface.tsx:338 🔍 REGISTER PUSH: Starting for room: vqfrj3 permission: granted
chat-interface.tsx:340 🏠 Registering push notifications for JOINED room: vqfrj3
chat-interface.tsx:351 🔄 Same room - skipping unsubscribe
chat-interface.tsx:113 🚀 Starting push notification setup...
chat-interface.tsx:120 ✅ Service worker supported
chat-interface.tsx:123 ⏳ Waiting for service worker ready...
chat-interface.tsx:473 📱 MOBILE: Chat interface received message: server-heartbeat {type: 'server-heartbeat'}
chat-interface.tsx:474 📱 MOBILE: WebSocket readyState: 1
install-prompt.tsx:95 === 5 Second Check ===
install-prompt.tsx:96 Deferred prompt available: false
install-prompt.tsx:97 All criteria met: true
install-prompt.tsx:100 ❌ No beforeinstallprompt event received
install-prompt.tsx:101 Chrome requires user engagement - try visiting the site multiple times
install-prompt.tsx:106 PWA criteria met but no install prompt - showing manual instructions
chat-interface.tsx:194 💥 Push notification setup failed at step: Service worker ready timeout after 5 seconds
setupPushNotifications @ chat-interface.tsx:194
await in setupPushNotifications
registerPushForRoom @ chat-interface.tsx:355
(anonymous) @ chat-interface.tsx:526
setTimeout
handleMessage @ chat-interface.tsx:520Understand this error
chat-interface.tsx:195 💥 Full error: Error: Service worker ready timeout after 5 seconds
    at chat-interface.tsx:127:35
setupPushNotifications @ chat-interface.tsx:195
await in setupPushNotifications
registerPushForRoom @ chat-interface.tsx:355
(anonymous) @ chat-interface.tsx:526
setTimeout
handleMessage @ chat-interface.tsx:520Understand this error
chat-interface.tsx:375 ❌ Room push registration failed: Error: Service worker ready timeout after 5 seconds
    at chat-interface.tsx:127:35
registerPushForRoom @ chat-interface.tsx:375
await in registerPushForRoom
(anonymous) @ chat-interface.tsx:526
setTimeout
handleMessage @ chat-interface.tsx:520Understand this error
chat-interface.tsx:527 ✅ CLIENT: registerPushForRoom call completed successfully
chat-interface.tsx:194 💥 Push notification setup failed at step: Service worker ready timeout after 5 seconds
setupPushNotifications @ chat-interface.tsx:194
await in setupPushNotifications
registerPushForRoom @ chat-interface.tsx:355
(anonymous) @ chat-interface.tsx:526
setTimeout
handleMessage @ chat-interface.tsx:520Understand this error
chat-interface.tsx:195 💥 Full error: Error: Service worker ready timeout after 5 seconds
    at chat-interface.tsx:127:35
setupPushNotifications @ chat-interface.tsx:195
await in setupPushNotifications
registerPushForRoom @ chat-interface.tsx:355
(anonymous) @ chat-interface.tsx:526
setTimeout
handleMessage @ chat-interface.tsx:520Understand this error
chat-interface.tsx:375 ❌ Room push registration failed: Error: Service worker ready timeout after 5 seconds
    at chat-interface.tsx:127:35
registerPushForRoom @ chat-interface.tsx:375
await in registerPushForRoom
(anonymous) @ chat-interface.tsx:526
setTimeout
handleMessage @ chat-interface.tsx:520Understand this error
chat-interface.tsx:527 ✅ CLIENT: registerPushForRoom call completed successfully